<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon"
        href="https://github.com/jonathanhdezf/residencialwifi/blob/main/fiberhub_logo_nebula.png?raw=true">
    <title>FiberHub v2.0 | Dashboard Residente</title>
    <link rel="stylesheet" href="./style.css" />
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="container" style="display: flex; justify-content: space-between; align-items: center;">
            <div class="logo">
                <img src="https://github.com/jonathanhdezf/residencialwifi/blob/main/fiberhub_logo_nebula.png?raw=true"
                    style="width: 35px; height: 35px; object-fit: contain;" alt="FiberHub Logo" title="FiberHub">
                FiberHub<span>Residente</span><span class="nebula-v2-badge">v2.0</span>
            </div>

            <div class="nav-profile-container">
                <div style="text-align: right; line-height: 1.2;">
                    <div id="userNameDisplay" style="font-weight: 600;">Cargando...</div>
                    <div id="userAliasDisplay" style="font-size: 0.8rem; color: var(--text-muted); cursor: pointer;">...
                    </div>
                </div>
                <!-- Resident Animated Door SVG -->
                <div class="nav-avatar resident" title="Portal Residente">
                    <svg class="door-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none">
                        <path class="door-frame" d="M5 4h14v17h-14z" />
                        <path class="door-door" d="M5 4h14v17h-14z" style="transform-origin: 5px 12px;" />
                        <circle class="door-knob" cx="16" cy="12.5" r="1.5" fill="currentColor"
                            style="pointer-events: none;" />
                    </svg>
                </div>
                <button id="logoutBtn" class="btn" style="padding: 0.5rem; margin-left: 0.5rem;" title="Cerrar Sesi√≥n">
                    ‚¨ÖÔ∏è Cerrar Sesi√≥n
                </button>
            </div>

            <!-- Hamburger Responsive -->
            <div class="menu-toggle" id="mobile-menu">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="menu-overlay" id="menu-overlay"></div>
        </div>
    </nav>


    <!-- Alias Modal -->
    <div id="aliasModal" class="modal-overlay">
        <div class="glass-panel modal-content-wrap" style="max-width: 380px;">
            <h3 style="margin-bottom: 1.5rem;">Configurar Alias</h3>
            <input type="text" id="aliasInput" class="form-input" placeholder="Ej. Familia Gonz√°lez"
                style="margin-bottom: 1rem;">
            <div style="display: flex; gap: 0.5rem; justify-content: flex-end;">
                <button id="cancelAliasBtn" class="btn"
                    style="border: 1px solid var(--border); background: transparent;">Cancelar</button>
                <button id="saveAliasBtn" class="btn btn-primary">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container fade-in">
        <div class="dashboard-grid">

            <!-- Payment Status Card -->
            <article class="glass-panel" style="padding: 2rem;">
                <h3 style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                    üìÖ Renta y Servicios de Internet
                </h3>
                <div style="margin-bottom: 1.5rem;">
                    <p style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.25rem;">Pr√≥ximo vencimiento
                    </p>
                    <p style="font-size: 1.25rem; font-weight: 600;" id="paymentDate">Cargando...</p>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span class="status-badge" id="paymentStatus">Cargando...</span>
                    <a href="#" id="viewHistoryBtn"
                        style="color: var(--accent); font-size: 0.9rem; text-decoration: none;">Ver historial</a>
                </div>
            </article>

            <!-- History Modal -->
            <div id="historyModal" class="modal-overlay">
                <div class="glass-panel modal-content-wrap"
                    style="max-height: 90vh; overflow-y: auto; display: flex; flex-direction: column;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; position: sticky; top: 0; background: rgba(9, 9, 11, 0.8); backdrop-filter: blur(10px); padding-bottom: 1rem; z-index: 5;">
                        <h3 style="margin: 0;">Historial de Pagos</h3>
                        <button id="closeHistoryBtn"
                            style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-muted); transition: color 0.2s;">&times;</button>
                    </div>

                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                            <thead>
                                <tr style="border-bottom: 1px solid var(--border); text-align: left;">
                                    <th style="padding: 0.5rem;">Periodo</th>
                                    <th style="padding: 0.5rem;">Fecha</th>
                                    <th style="padding: 0.5rem;">Monto</th>
                                    <th style="padding: 0.5rem;">Estado</th>
                                    <th style="padding: 0.5rem; text-align: center;">Recibo</th>
                                </tr>
                            </thead>
                            <tbody id="historyTableBody">
                                <!-- Data -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Connectivity Card -->
            <article class="glass-panel" style="padding: 2rem;">
                <h3 style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                    üöÄ Conexi√≥n de Red
                </h3>
                <div style="display: flex; align-items: baseline; gap: 0.5rem;">
                    <span style="font-size: 2.5rem; font-weight: 700; color: var(--text-main);" id="speedValue">0</span>
                    <span style="font-size: 1rem; color: var(--text-muted);">Mbps</span>
                </div>
                <div class="speed-meter-container">
                    <div class="speed-bar-bg">
                        <div class="speed-bar-fill" id="speedBar"></div>
                    </div>
                </div>

                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 0.5rem;">
                    <p style="font-size: 0.8rem; color: var(--text-muted); margin: 0;">Fibra √ìptica Dedicada</p>

                </div>
            </article>

            <!-- Speed Test Modal (Responsive) -->
            <!-- Speed Test Modal -->
            <div id="speedTestModal" class="modal-overlay">
                <div class="glass-panel modal-content-wrap"
                    style="max-width: 420px; text-align: center; padding: 2rem;">
                    <h3 style="margin-bottom: 2rem; color: var(--text-main); font-size: 1.5rem;">Midiendo Velocidad</h3>

                    <!-- Gauge Container (Simple) -->
                    <div
                        style="position: relative; width: 250px; height: 125px; margin: 0 auto 2rem auto; overflow: hidden;">

                        <!-- Gauge Background -->
                        <div style="
                            position: absolute;
                            bottom: 0; left: 0;
                            width: 250px; height: 250px;
                            border-radius: 50%;
                            border: 20px solid rgba(255,255,255,0.1);
                            box-sizing: border-box;
                        "></div>

                        <!-- Gauge Fill -->
                        <div id="gaugeFill" style="
                            position: absolute;
                            bottom: 0; left: 0;
                            width: 250px; height: 250px;
                            border-radius: 50%;
                            border: 20px solid transparent;
                            border-top-color: var(--accent);
                            border-right-color: var(--accent);
                            box-sizing: border-box;
                            transform: rotate(-135deg); 
                            transform-origin: center;
                            transition: transform 0.1s ease-out;
                        "></div>

                        <!-- Needle -->
                        <div id="gaugeNeedle" style="
                            position: absolute;
                            bottom: 0; left: 125px;
                            width: 4px; height: 110px;
                            background: white;
                            transform-origin: bottom center;
                            transform: rotate(-90deg);
                            transition: transform 0.2s cubic-bezier(0.1, 1.5, 0.4, 1);
                            z-index: 10;
                        "></div>
                    </div>

                    <!-- Speed Display -->
                    <div style="margin-bottom: 2rem;">
                        <span id="liveSpeedVal"
                            style="font-size: 4rem; font-weight: 800; color: var(--accent); font-family: monospace;">0.0</span>
                        <div style="color: var(--text-muted); font-size: 1rem;">MBPS</div>
                    </div>



                    <button id="closeSpeedTest" class="btn"
                        style="border: 1px solid var(--border); background: transparent; padding: 0.5rem 2rem; display: none;">
                        Cerrar
                    </button>
                    <p id="testStatus" style="color: var(--text-muted); font-size: 0.9rem; margin-top: 1rem;">Iniciando
                        prueba...</p>
                </div>
            </div>

        </div>



        <!-- WiFi Details Card -->
        <article class="glass-panel" style="padding: 2rem; grid-column: span 2;">
            <h3 style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1.5rem;">
                üì° Detalles WiFi
            </h3>

            <div style="display: flex; gap: 2rem; align-items: center; flex-wrap: wrap;">
                <!-- QR Code -->
                <div style="background: white; padding: 1rem; border-radius: 12px; height: fit-content;">
                    <img id="dashWifiQr" src="" alt="Escanee para conectar"
                        style="width: 140px; height: 140px; object-fit: contain; display: none;">
                    <div id="dashQrPlaceholder"
                        style="width: 140px; height: 140px; display: flex; align-items: center; justify-content: center; text-align: center; color: #333; font-size: 0.8rem;">
                        No configurado
                    </div>
                </div>

                <!-- Text Details -->
                <div style="flex: 1; display: flex; flex-direction: column; gap: 1rem;">
                    <div>
                        <span
                            style="font-size: 0.85rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em;">Nombre
                            de Red (SSID)</span>
                        <div style="font-size: 1.5rem; font-weight: 600; color: var(--primary);" id="dashSsid">
                            ...
                        </div>
                    </div>
                    <div>
                        <span
                            style="font-size: 0.85rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em;">Contrase√±a</span>
                        <div
                            style="font-size: 1.25rem; font-family: monospace; background: rgba(255,255,255,0.05); padding: 0.5rem 1rem; border-radius: 6px; border: 1px solid var(--border); display: inline-block;">
                            <span id="dashPass">...</span>
                        </div>
                    </div>
                    <p style="font-size: 0.85rem; opacity: 0.7; margin: 0;">
                        üì∑ Escanee el c√≥digo QR con su celular para conectarse autom√°ticamente.
                    </p>
                </div>
            </div>
        </article>
        </div>

        <!-- Especial Services Section -->
        <section class="glass-panel" style="margin-top: 3rem; margin-bottom: 3rem; padding: 2rem;">
            <h3
                style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1.5rem; justify-content: center;">
                ‚ú® Servicios Especiales
            </h3>
            <div style="display: flex; justify-content: center; align-items: center;">
                <a href="https://www.clarovideo.com/mexico/landing" target="_blank" rel="noopener"
                    style="transition: transform 0.3s ease;">
                    <img src="https://i.blogs.es/442c56/claro-/450_1000.jpg" alt="Claro Video"
                        style="width: 250px; height: auto; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); border: 2px solid rgba(255,255,255,0.1);"
                        onmouseover="this.parentElement.style.transform='scale(1.05)'"
                        onmouseout="this.parentElement.style.transform='scale(1)'">
                </a>
            </div>
            <div style="display: flex; justify-content: center; align-items: center;">
                <a href="https://www.netflix.com/mx/" target="_blank" rel="noopener"
                    style="transition: transform 0.3s ease;">
                    <img src="https://tse2.mm.bing.net/th/id/OIP.USRGLnk6iOi0Hakpo6VLMgHaEK?rs=1&pid=ImgDetMain&o=7&rm=3"
                        alt="Netflix"
                        style="width: 250px; height: auto; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); border: 2px solid rgba(255,255,255,0.1);"
                        onmouseover="this.parentElement.style.transform='scale(1.05)'"
                        onmouseout="this.parentElement.style.transform='scale(1)'">
                </a>
            </div>
        </section>

        <!-- Messages Section -->
        <section class="glass-panel" style="margin-bottom: 2rem; padding: 2rem;">
            <h3 style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                üí¨ Mensajes con Administraci√≥n
            </h3>

            <div class="message-list" id="messageList">
                <!-- Messages populated by JS -->
            </div>

            <form id="messageForm" style="display: flex; flex-direction: column; gap: 0.5rem;">
                <div class="emoji-bar" style="display: flex; gap: 0.5rem; overflow-x: auto; padding-bottom: 0.25rem;">
                    <button type="button" class="btn-emoji"
                        style="background:none; border:none; cursor:pointer; font-size:1.2rem;">üòÄ</button>
                    <button type="button" class="btn-emoji"
                        style="background:none; border:none; cursor:pointer; font-size:1.2rem;">üòÇ</button>
                    <button type="button" class="btn-emoji"
                        style="background:none; border:none; cursor:pointer; font-size:1.2rem;">üëç</button>
                    <button type="button" class="btn-emoji"
                        style="background:none; border:none; cursor:pointer; font-size:1.2rem;">üëã</button>
                    <button type="button" class="btn-emoji"
                        style="background:none; border:none; cursor:pointer; font-size:1.2rem;">üéâ</button>
                    <button type="button" class="btn-emoji"
                        style="background:none; border:none; cursor:pointer; font-size:1.2rem;">‚ù§Ô∏è</button>
                    <button type="button" class="btn-emoji"
                        style="background:none; border:none; cursor:pointer; font-size:1.2rem;">‚ö†Ô∏è</button>
                    <button type="button" class="btn-emoji"
                        style="background:none; border:none; cursor:pointer; font-size:1.2rem;">üìÖ</button>
                    <button type="button" class="btn-emoji"
                        style="background:none; border:none; cursor:pointer; font-size:1.2rem;">üöÄ</button>
                    <button type="button" class="btn-emoji"
                        style="background:none; border:none; cursor:pointer; font-size:1.2rem;">üí¨</button>
                </div>
                <div style="display: flex; gap: 0.5rem;">
                    <input type="text" class="form-input" placeholder="Escribe un mensaje..." style="flex: 1;" required
                        id="messageInput" />
                    <button type="submit" class="btn btn-primary">
                        Enviar
                    </button>
                </div>
            </form>
        </section>

        <footer class="app-footer">
            Desarrollado con ‚ù§Ô∏è por <a href="#" style="color: var(--primary);">Fiberlink Servicios TIC</a> | ¬© 2026
        </footer>
    </main>

    <script type="module" src="./dashboard.js"></script>
    <script>
        // Hamburger Menu Logic
        const menuToggle = document.getElementById('mobile-menu');
        const navMenu = document.querySelector('.nav-profile-container');
        const menuOverlay = document.getElementById('menu-overlay');

        if (menuToggle) {
            menuToggle.addEventListener('click', () => {
                menuToggle.classList.toggle('active');
                navMenu.classList.toggle('active');
                menuOverlay.classList.toggle('active');
            });
        }

        if (menuOverlay) {
            menuOverlay.addEventListener('click', () => {
                menuToggle.classList.remove('active');
                navMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
            });
        }
    </script>

</body>

</html>