<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon"
        href="https://github.com/jonathanhdezf/residencialwifi/blob/main/fiberhub_logo_nebula.png?raw=true">
    <title>FiberHub v2.0 | Dashboard Residente</title>
    <link rel="stylesheet" href="./style.css" />
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="container flex-between">
            <div class="logo">
                <img src="https://github.com/jonathanhdezf/residencialwifi/blob/main/fiberhub_logo_nebula.png?raw=true"
                    class="qr-img" style="width: 35px; height: 35px;" alt="FiberHub Logo" title="FiberHub">
                FiberHub<span>Residente</span><span class="nebula-v2-badge">v2.0</span>
            </div>

            <div class="nav-profile-container">
                <div class="text-right" style="line-height: 1.2;">
                    <div id="userNameDisplay" class="font-semibold">Cargando...</div>
                    <div id="userAliasDisplay" class="text-sm text-muted-color cursor-pointer">...
                    </div>
                </div>
                <!-- Resident Animated Door SVG -->
                <div class="nav-avatar resident" title="Portal Residente">
                    <svg class="door-icon" viewBox="0 0 24 24" stroke="currentColor" fill="none">
                        <path class="door-frame" d="M5 4h14v17h-14z" />
                        <path class="door-door" d="M5 4h14v17h-14z" style="transform-origin: 5px 12px;" />
                        <circle class="door-knob" cx="16" cy="12.5" r="1.5" fill="currentColor"
                            style="pointer-events: none;" />
                    </svg>
                </div>
                <button id="logoutBtn" class="btn p-2" style="margin-left: 0.5rem;" title="Cerrar Sesi√≥n">
                    ‚¨ÖÔ∏è Cerrar Sesi√≥n
                </button>
            </div>

            <!-- Hamburger Responsive -->
            <div class="menu-toggle" id="mobile-menu">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <div class="menu-overlay" id="menu-overlay"></div>
        </div>
    </nav>


    <!-- Alias Modal -->
    <div id="aliasModal" class="modal-overlay">
        <div class="glass-panel modal-content-wrap" style="max-width: 380px;">
            <h3 class="mb-3">Configurar Alias</h3>
            <input type="text" id="aliasInput" class="form-input mb-2" placeholder="Ej. Familia Gonz√°lez">
            <div class="flex gap-1 justify-center" style="justify-content: flex-end;">
                <button id="cancelAliasBtn" class="btn"
                    style="border: 1px solid var(--border); background: transparent;">Cancelar</button>
                <button id="saveAliasBtn" class="btn btn-primary">Guardar</button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container fade-in">
        <div class="dashboard-grid">

            <!-- Payment Status Card -->
            <article class="glass-panel p-4">
                <h3 class="flex-align-center gap-1 mb-2">
                    üìÖ Renta y Servicios de Internet
                </h3>
                <div class="mb-3">
                    <p class="text-sm text-muted-color mb-1">Pr√≥ximo vencimiento</p>
                    <p class="font-semibold" style="font-size: 1.25rem;" id="paymentDate">Cargando...</p>
                </div>
                <div class="flex-between">
                    <span class="status-badge" id="paymentStatus">Cargando...</span>
                    <a href="#" id="viewHistoryBtn"
                        style="color: var(--accent); font-size: 0.9rem; text-decoration: none;">Ver historial</a>
                </div>
            </article>

            <!-- History Modal -->
            <div id="historyModal" class="modal-overlay">
                <div class="glass-panel modal-content-wrap"
                    style="max-height: 90vh; overflow-y: auto; display: flex; flex-direction: column;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; position: sticky; top: 0; background: rgba(9, 9, 11, 0.8); backdrop-filter: blur(10px); padding-bottom: 1rem; z-index: 5;">
                        <h3 style="margin: 0;">Historial de Pagos</h3>
                        <button id="closeHistoryBtn"
                            style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-muted); transition: color 0.2s;">&times;</button>
                    </div>

                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                            <thead>
                                <tr style="border-bottom: 1px solid var(--border); text-align: left;">
                                    <th style="padding: 0.5rem;">Periodo</th>
                                    <th style="padding: 0.5rem;">Fecha</th>
                                    <th style="padding: 0.5rem;">Monto</th>
                                    <th style="padding: 0.5rem;">Estado</th>
                                    <th style="padding: 0.5rem; text-align: center;">Recibo</th>
                                </tr>
                            </thead>
                            <tbody id="historyTableBody">
                                <!-- Data -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Connectivity Card -->
            <article class="glass-panel p-4">
                <h3 class="flex-align-center gap-1 mb-2">
                    üöÄ Conexi√≥n de Red
                </h3>
                <div class="flex gap-1" style="align-items: baseline;">
                    <span class="font-bold" style="font-size: 2.5rem; color: var(--text-main);" id="speedValue">0</span>
                    <span style="font-size: 1rem; color: var(--text-muted);">Mbps</span>
                </div>
                <div class="speed-meter-container">
                    <div class="speed-bar-bg">
                        <div class="speed-bar-fill" id="speedBar"></div>
                    </div>
                </div>

                <div class="flex-between mt-2">
                    <p class="text-xs text-muted-color m-0">Fibra √ìptica Dedicada</p>
                </div>
            </article>

            <!-- Speed Test Modal (Responsive) -->
            <!-- Speed Test Modal -->
            <div id="speedTestModal" class="modal-overlay">
                <div class="glass-panel modal-content-wrap"
                    style="max-width: 420px; text-align: center; padding: 2rem;">
                    <h3 style="margin-bottom: 2rem; color: var(--text-main); font-size: 1.5rem;">Midiendo Velocidad</h3>

                    <!-- Gauge Container (Simple) -->
                    <div
                        style="position: relative; width: 250px; height: 125px; margin: 0 auto 2rem auto; overflow: hidden;">

                        <!-- Gauge Background -->
                        <div style="
                            position: absolute;
                            bottom: 0; left: 0;
                            width: 250px; height: 250px;
                            border-radius: 50%;
                            border: 20px solid rgba(255,255,255,0.1);
                            box-sizing: border-box;
                        "></div>

                        <!-- Gauge Fill -->
                        <div id="gaugeFill" style="
                            position: absolute;
                            bottom: 0; left: 0;
                            width: 250px; height: 250px;
                            border-radius: 50%;
                            border: 20px solid transparent;
                            border-top-color: var(--accent);
                            border-right-color: var(--accent);
                            box-sizing: border-box;
                            transform: rotate(-135deg); 
                            transform-origin: center;
                            transition: transform 0.1s ease-out;
                        "></div>

                        <!-- Needle -->
                        <div id="gaugeNeedle" style="
                            position: absolute;
                            bottom: 0; left: 125px;
                            width: 4px; height: 110px;
                            background: white;
                            transform-origin: bottom center;
                            transform: rotate(-90deg);
                            transition: transform 0.2s cubic-bezier(0.1, 1.5, 0.4, 1);
                            z-index: 10;
                        "></div>
                    </div>

                    <!-- Speed Display -->
                    <div style="margin-bottom: 2rem;">
                        <span id="liveSpeedVal"
                            style="font-size: 4rem; font-weight: 800; color: var(--accent); font-family: monospace;">0.0</span>
                        <div style="color: var(--text-muted); font-size: 1rem;">MBPS</div>
                    </div>



                    <button id="closeSpeedTest" class="btn"
                        style="border: 1px solid var(--border); background: transparent; padding: 0.5rem 2rem; display: none;">
                        Cerrar
                    </button>
                    <p id="testStatus" style="color: var(--text-muted); font-size: 0.9rem; margin-top: 1rem;">Iniciando
                        prueba...</p>
                </div>
            </div>

        </div>



        <!-- WiFi Details Card -->
        <article class="glass-panel p-4" style="grid-column: span 2;">
            <h3 class="flex-align-center gap-1 mb-3">
                üì° Detalles WiFi
            </h3>

            <div class="flex gap-4 flex-align-center flex-wrap">
                <!-- QR Code -->
                <div class="qr-container">
                    <img id="dashWifiQr" src="" alt="Escanee para conectar" class="qr-img" style="display: none;">
                    <div id="dashQrPlaceholder" class="qr-placeholder">
                        No configurado
                    </div>
                </div>

                <!-- Text Details -->
                <div class="flex flex-col gap-2" style="flex: 1;">
                    <div>
                        <span class="text-sm text-muted-color"
                            style="text-transform: uppercase; letter-spacing: 0.05em;">Nombre
                            de Red (SSID)</span>
                        <div class="font-semibold" style="font-size: 1.5rem; color: var(--primary);" id="dashSsid">
                            ...
                        </div>
                    </div>
                    <div>
                        <span class="text-sm text-muted-color"
                            style="text-transform: uppercase; letter-spacing: 0.05em;">Contrase√±a</span>
                        <div
                            style="font-size: 1.25rem; font-family: monospace; background: rgba(255,255,255,0.05); padding: 0.5rem 1rem; border-radius: 6px; border: 1px solid var(--border); display: inline-block;">
                            <span id="dashPass">...</span>
                        </div>
                    </div>
                    <p class="text-sm" style="opacity: 0.7; margin: 0;">
                        üì∑ Escanee el c√≥digo QR con su celular para conectarse autom√°ticamente.
                    </p>
                </div>
            </div>
        </article>
        </div>

        <!-- Especial Services Section -->
        <section class="glass-panel services-section">
            <h3 class="flex-center gap-1 mb-3">
                ‚ú® Servicios Especiales
            </h3>
            <p class="flex-center gap-1 mb-3 mt-4">
                Claro Video (Gratis):
            </p>
            <div class="flex-center">
                <a href="https://www.clarovideo.com/mexico/landing" target="_blank" rel="noopener" class="service-item">
                    <img src="https://fotos.e-consulta.com/clarovideo_2.jpg" alt="Pluto TV" class="service-img">
                </a>
            </div>

            <p class="flex-center gap-1 mb-3 mt-4">
                Pluto TV (Gratis):
            </p>
            <div class="flex-center">
                <a href="https://pluto.tv/" target="_blank" rel="noopener" class="service-item">
                    <img src="pluto_tv_banner_1770677363423.png" alt="Pluto TV" class="service-img">
                </a>
            </div>

            <p class="flex-center gap-1 mb-3 mt-4">
                TUBI (Gratis):
            </p>
            <div class="flex-center">
                <a href="https://tubitv.com/" target="_blank" rel="noopener" class="service-item">
                    <img src="tubi_banner_1770677338648.png" alt="Tubi" class="service-img">
                </a>
            </div>

            <p class="flex-center gap-1 mb-3 mt-4">
                Suscripci√≥n:
            </p>
            <div class="flex-center">
                <a href="https://www.netflix.com/mx/" target="_blank" rel="noopener" class="service-item">
                    <img src="https://tse2.mm.bing.net/th/id/OIP.USRGLnk6iOi0Hakpo6VLMgHaEK?rs=1&pid=ImgDetMain&o=7&rm=3"
                        alt="Netflix" class="service-img">
                </a>
            </div>
        </section>

        <!-- Messages Section -->
        <section class="glass-panel" style="margin-bottom: 2rem; padding: 2rem;">
            <h3 style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem;">
                üí¨ Mensajes con Administraci√≥n
            </h3>

            <div class="message-list" id="messageList">
                <!-- Messages populated by JS -->
            </div>

            <form id="messageForm" class="flex flex-col gap-1">
                <div class="emoji-bar flex gap-1">
                    <button type="button" class="btn-emoji">üòÄ</button>
                    <button type="button" class="btn-emoji">üòÇ</button>
                    <button type="button" class="btn-emoji">üëç</button>
                    <button type="button" class="btn-emoji">üëã</button>
                    <button type="button" class="btn-emoji">üéâ</button>
                    <button type="button" class="btn-emoji">‚ù§Ô∏è</button>
                    <button type="button" class="btn-emoji">‚ö†Ô∏è</button>
                    <button type="button" class="btn-emoji">üìÖ</button>
                    <button type="button" class="btn-emoji">üöÄ</button>
                    <button type="button" class="btn-emoji">üí¨</button>
                </div>
                <div class="flex gap-1">
                    <input type="text" class="form-input flex-1" placeholder="Escribe un mensaje..." required
                        id="messageInput" />
                    <button type="submit" class="btn btn-primary">
                        Enviar
                    </button>
                </div>
            </form>
        </section>

        <footer class="app-footer">
            Desarrollado con ‚ù§Ô∏è por <a href="#" style="color: var(--primary);">Fiberlink Servicios TIC</a> | ¬© 2026
        </footer>
    </main>

    <script type="module" src="./dashboard.js"></script>
    <script>
        // Hamburger Menu Logic
        const menuToggle = document.getElementById('mobile-menu');
        const navMenu = document.querySelector('.nav-profile-container');
        const menuOverlay = document.getElementById('menu-overlay');

        if (menuToggle) {
            menuToggle.addEventListener('click', () => {
                menuToggle.classList.toggle('active');
                navMenu.classList.toggle('active');
                menuOverlay.classList.toggle('active');
            });
        }

        if (menuOverlay) {
            menuOverlay.addEventListener('click', () => {
                menuToggle.classList.remove('active');
                navMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
            });
        }
    </script>

</body>

</html>